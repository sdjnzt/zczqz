import{d as $e,Y as te,a as r,i as Pe,A as De,e as N,k as y,c as V,z as w,j as l,b as a,r as i,Z as Be,F as ae,f as ne,q as s,m as A,at as oe,M as je,t as R,W as S,X as ie,o as v}from"./vendor-iaJEqiR6.js";import{d as z}from"./buttonActions-DIXrA_ga.js";import{_ as Fe}from"./index-CLUnicPH.js";const Ee={class:"user-container"},Me={class:"operation-bar"},Ie={class:"operation-buttons"},Ne={class:"pagination"},Ae={class:"dialog-footer"},Ke={class:"role-operation"},Oe={class:"table-actions"},We=$e({__name:"index",setup(Xe){const o=te({keyword:"",role:"",status:""}),q=[{label:"系统管理员",value:"系统管理员"},{label:"社区管理员",value:"社区管理员"},{label:"网格员",value:"网格员"},{label:"便民服务人员",value:"便民服务人员"},{label:"养老服务专员",value:"养老服务专员"},{label:"文化活动专员",value:"文化活动专员"},{label:"环境监测员",value:"环境监测员"},{label:"志愿服务管理员",value:"志愿服务管理员"},{label:"社区医生",value:"社区医生"}],f=[{id:1,username:"wangxq",name:"王晓强",phone:"13953701245",email:"wangxq@xinglongzhuang.gov.cn",department:"街道信息化办公室",position:"主任",role:"系统管理员",status:"active",lastLogin:"2025-06-03 08:12",createTime:"2025-06-02 09:23"},{id:2,username:"liwn",name:"李文娜",phone:"13853712561",email:"liwn@xinglongzhuang.gov.cn",department:"街道信息化办公室",position:"副主任",role:"社区管理员",status:"active",lastLogin:"2025-06-07 10:45",createTime:"2025-06-06 14:11"},{id:3,username:"liuzhy",name:"刘志洋",phone:"18653734576",email:"liuzhy@xinglongzhuang.gov.cn",department:"社区服务中心",position:"网格员",role:"网格员",status:"active",lastLogin:"2025-06-10 16:08",createTime:"2025-06-09 13:37"},{id:4,username:"zhanglm",name:"张丽敏",phone:"15053745652",email:"zhanglm@xinglongzhuang.gov.cn",department:"便民服务中心",position:"便民服务人员",role:"便民服务人员",status:"active",lastLogin:"2025-06-12 09:56",createTime:"2025-06-11 10:05"},{id:5,username:"chengl",name:"陈国磊",phone:"15153756984",email:"chengl@xinglongzhuang.gov.cn",department:"社区服务中心",position:"养老服务专员",role:"养老服务专员",status:"active",lastLogin:"2025-06-15 11:22",createTime:"2025-06-14 08:44"},{id:6,username:"sunxy",name:"孙晓宇",phone:"15253767690",email:"sunxy@xinglongzhuang.gov.cn",department:"社区服务中心",position:"文化活动专员",role:"文化活动专员",status:"active",lastLogin:"2025-06-16 15:33",createTime:"2025-06-15 16:18"},{id:7,username:"zhoujl",name:"周建林",phone:"15353778901",email:"zhoujl@xinglongzhuang.gov.cn",department:"社区服务中心",position:"环境监测员",role:"环境监测员",status:"active",lastLogin:"2025-06-17 07:41",createTime:"2025-06-16 12:29"},{id:8,username:"huangyy",name:"黄雅雯",phone:"15553789012",email:"huangyy@xinglongzhuang.gov.cn",department:"社区服务中心",position:"志愿服务管理员",role:"志愿服务管理员",status:"active",lastLogin:"2025-06-18 18:09",createTime:"2025-06-17 19:55"},{id:9,username:"liuhh",name:"刘慧慧",phone:"15653790123",email:"liuhh@xinglongzhuang.gov.cn",department:"社区卫生服务站",position:"社区医生",role:"社区医生",status:"active",lastLogin:"2025-06-19 20:17",createTime:"2025-06-18 21:03"},{id:10,username:"gaoyt",name:"高宇涛",phone:"15753791234",email:"gaoyt@xinglongzhuang.gov.cn",department:"街道信息化办公室",position:"系统管理员",role:"系统管理员",status:"active",lastLogin:"2025-06-20 13:28",createTime:"2025-06-19 14:39"},{id:11,username:"songq",name:"宋倩",phone:"15853792345",email:"songq@xinglongzhuang.gov.cn",department:"社区服务中心",position:"文化活动专员",role:"文化活动专员",status:"active",lastLogin:"2025-06-21 09:10",createTime:"2025-06-20 10:20"},{id:12,username:"weid",name:"魏东",phone:"15953793456",email:"weid@xinglongzhuang.gov.cn",department:"社区服务中心",position:"环境监测员",role:"环境监测员",status:"active",lastLogin:"2025-06-22 11:15",createTime:"2025-06-21 12:30"},{id:13,username:"fengy",name:"冯媛",phone:"13653794567",email:"fengy@xinglongzhuang.gov.cn",department:"社区卫生服务站",position:"社区医生",role:"社区医生",status:"active",lastLogin:"2025-06-23 14:25",createTime:"2025-06-22 15:40"},{id:14,username:"zhangl",name:"张磊",phone:"13753795678",email:"zhangl@xinglongzhuang.gov.cn",department:"街道信息化办公室",position:"系统管理员",role:"系统管理员",status:"active",lastLogin:"2025-06-24 16:35",createTime:"2025-06-23 17:50"},{id:15,username:"liuy",name:"刘洋",phone:"13853796789",email:"liuy@xinglongzhuang.gov.cn",department:"社区服务中心",position:"养老服务专员",role:"养老服务专员",status:"active",lastLogin:"2025-06-25 18:45",createTime:"2025-06-24 19:00"},{id:16,username:"sunl",name:"孙磊",phone:"13953797890",email:"sunl@xinglongzhuang.gov.cn",department:"社区服务中心",position:"便民服务人员",role:"便民服务人员",status:"active",lastLogin:"2025-06-26 20:55",createTime:"2025-06-25 21:10"},{id:17,username:"zhangy",name:"张艳",phone:"15053798901",email:"zhangy@xinglongzhuang.gov.cn",department:"社区服务中心",position:"志愿服务管理员",role:"志愿服务管理员",status:"active",lastLogin:"2025-06-27 08:05",createTime:"2025-06-26 09:20"},{id:18,username:"liuq",name:"刘强",phone:"15153799012",email:"liuq@xinglongzhuang.gov.cn",department:"社区服务中心",position:"网格员",role:"网格员",status:"active",lastLogin:"2025-06-28 10:15",createTime:"2025-06-27 11:30"},{id:19,username:"wangf",name:"王芳",phone:"15253790123",email:"wangf@xinglongzhuang.gov.cn",department:"社区服务中心",position:"社区管理员",role:"社区管理员",status:"active",lastLogin:"2025-06-29 12:25",createTime:"2025-06-28 13:40"},{id:20,username:"chenj",name:"陈静",phone:"15353791234",email:"chenj@xinglongzhuang.gov.cn",department:"社区服务中心",position:"便民服务人员",role:"便民服务人员",status:"active",lastLogin:"2025-06-30 14:35",createTime:"2025-06-29 15:50"}],K=r([]),_=r(1),h=r(10),$=r(100),b=r(!1),T=r("add"),P=r(),u=te({id:0,username:"",name:"",phone:"",email:"",department:"",position:"",role:"",status:"正常",lastLogin:"",createTime:""}),D=r(!1),B=r("list"),C=r([]),se=r(),O=r([{id:1,name:"系统管理",children:[{id:11,name:"用户管理"},{id:12,name:"角色管理"},{id:13,name:"权限管理"}]},{id:2,name:"设备管理",children:[{id:21,name:"设备列表"},{id:22,name:"设备监控"},{id:23,name:"设备维护"}]}]),W=r([11,21]),X=n=>{const e=q.find(d=>d.value===n);return e?e.label:n},g=()=>{let n=[...f];o.keyword&&(n=n.filter(e=>e.username.includes(o.keyword)||e.phone.includes(o.keyword))),o.role&&(n=n.filter(e=>e.role===o.role)),o.status&&(n=n.filter(e=>e.status===o.status)),$.value=n.length,K.value=n.slice((_.value-1)*h.value,_.value*h.value)},Y=()=>{o.keyword="",o.role="",o.status="",_.value=1,g()},ue=()=>{T.value="add",b.value=!0,Object.assign(u,{id:Date.now(),username:"",name:"",phone:"",email:"",department:"",position:"",role:"",status:"正常",lastLogin:"",createTime:""})},re=n=>{T.value="edit",b.value=!0,Object.assign(u,n)},de=n=>{z.delete("用户",n.username,()=>{const e=f.findIndex(d=>d.id===n.id);e!==-1&&(f.splice(e,1),g(),$.value=f.length)})},me=n=>{const e=z.toggleStatus("用户",n.status,d=>{n.status=d});n.status=e},pe=async()=>{P.value&&await P.value.validate(n=>{if(n){if(T.value==="add"){const e={...u,id:Date.now(),createTime:new Date().toLocaleString(),lastLogin:""};f.unshift(e),g(),S.success("新增成功")}else{const e=f.findIndex(d=>d.id===u.id);e!==-1&&(f[e]={...u,id:u.id,createTime:u.createTime,lastLogin:u.lastLogin},g(),S.success("修改成功"))}b.value=!1}})},ge=n=>{h.value=n,g()},ce=n=>{_.value=n,g()},ve=()=>{D.value=!0},fe=()=>{ie.prompt("请输入新角色名称","新增角色",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/^.{2,20}$/,inputErrorMessage:"角色名称长度为2-20个字符"}).then(({value:n})=>{const e={id:Date.now(),name:n,description:"",permissions:[],createTime:new Date().toLocaleString()};C.value.push(e),z.add("角色")})},_e=n=>{ie.prompt("请输入新的角色名称","编辑角色",{confirmButtonText:"确定",cancelButtonText:"取消",inputValue:n.name,inputPattern:/^.{2,20}$/,inputErrorMessage:"角色名称长度为2-20个字符"}).then(({value:e})=>{n.name=e,z.edit("角色")})},be=n=>{z.delete("角色",n.name,()=>{const e=C.value.findIndex(d=>d.id===n.id);e!==-1&&C.value.splice(e,1)})},ye=n=>{B.value="permission",W.value=[11,21],S.info(`为角色【${n.name}】分配权限（仅模拟）`)},k=r(!1),he=r([]),ke=r(null),Z=r(),xe=n=>{var e;ke.value=n.id,(e=Z.value)==null||e.setCheckedKeys(["1","1-1","1-2"]),k.value=!0},Ve=()=>{S.success("权限已保存（仅模拟）"),k.value=!1},G=Pe(()=>!!o.role||!!o.status||!!o.keyword),j=n=>{o[n]="",_.value=1,g()},we={username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}],name:[{required:!0,message:"请输入姓名",trigger:"blur"}],phone:[{required:!0,message:"请输入手机号",trigger:"blur"},{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入正确的邮箱地址",trigger:"blur"}],role:[{required:!0,message:"请选择角色",trigger:"change"}]};return De(()=>{g()}),(n,e)=>{const d=i("el-input"),c=i("el-form-item"),L=i("el-option"),F=i("el-select"),m=i("el-button"),H=i("el-form"),E=i("el-icon"),U=i("el-tag"),ze=i("el-row"),p=i("el-table-column"),Te=i("el-switch"),M=i("el-dropdown-item"),Ce=i("el-dropdown-menu"),Le=i("el-dropdown"),J=i("el-table"),Ue=i("el-pagination"),Re=i("el-card"),Q=i("el-radio"),Se=i("el-radio-group"),I=i("el-dialog"),ee=i("el-tree"),le=i("el-tab-pane"),qe=i("el-tabs");return v(),N("div",Ee,[y("div",Me,[l(H,{inline:!0,model:o,class:"search-form"},{default:a(()=>[l(c,null,{default:a(()=>[l(d,{modelValue:o.keyword,"onUpdate:modelValue":e[0]||(e[0]=t=>o.keyword=t),placeholder:"用户名/手机号",clearable:"",onKeyup:Be(g,["enter"])},null,8,["modelValue"])]),_:1}),l(c,null,{default:a(()=>[l(F,{modelValue:o.role,"onUpdate:modelValue":e[1]||(e[1]=t=>o.role=t),placeholder:"角色",clearable:"",style:{width:"140px"}},{default:a(()=>[(v(),N(ae,null,ne(q,t=>l(L,{key:t.value,label:t.label,value:t.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),l(c,null,{default:a(()=>[l(F,{modelValue:o.status,"onUpdate:modelValue":e[2]||(e[2]=t=>o.status=t),placeholder:"状态",clearable:"",style:{width:"140px"}},{default:a(()=>[l(L,{label:"启用",value:"active"}),l(L,{label:"禁用",value:"inactive"})]),_:1},8,["modelValue"])]),_:1}),l(c,null,{default:a(()=>[l(m,{type:"primary",onClick:g},{default:a(()=>e[20]||(e[20]=[s("搜索")])),_:1,__:[20]}),l(m,{onClick:Y},{default:a(()=>e[21]||(e[21]=[s("重置")])),_:1,__:[21]})]),_:1})]),_:1},8,["model"]),y("div",Ie,[l(m,{type:"primary",onClick:ue},{default:a(()=>[l(E,null,{default:a(()=>[l(A(oe))]),_:1}),e[22]||(e[22]=s("新增用户 "))]),_:1,__:[22]}),l(m,{type:"success",onClick:ve},{default:a(()=>[l(E,null,{default:a(()=>[l(A(je))]),_:1}),e[23]||(e[23]=s("角色管理 "))]),_:1,__:[23]})])]),G.value?(v(),V(ze,{key:0,class:"filter-tags",style:{"margin-bottom":"10px"}},{default:a(()=>[o.role?(v(),V(U,{key:0,type:"info",closable:"",onClose:e[3]||(e[3]=()=>j("role"))},{default:a(()=>[s(" 角色："+R(X(o.role)),1)]),_:1})):w("",!0),o.status?(v(),V(U,{key:1,type:"info",closable:"",onClose:e[4]||(e[4]=()=>j("status"))},{default:a(()=>[s(" 状态："+R(o.status==="active"?"启用":"禁用"),1)]),_:1})):w("",!0),o.keyword?(v(),V(U,{key:2,type:"info",closable:"",onClose:e[5]||(e[5]=()=>j("keyword"))},{default:a(()=>[s(" 关键词："+R(o.keyword),1)]),_:1})):w("",!0),G.value?(v(),V(m,{key:3,size:"small",type:"text",onClick:Y},{default:a(()=>e[24]||(e[24]=[s("清除全部")])),_:1,__:[24]})):w("",!0)]),_:1})):w("",!0),l(Re,{class:"user-list"},{default:a(()=>[l(J,{data:K.value,border:"",style:{width:"100%"},"highlight-current-row":""},{default:a(()=>[l(p,{type:"selection",width:"55"}),l(p,{prop:"username",label:"用户名","min-width":"120"}),l(p,{prop:"name",label:"姓名","min-width":"120"}),l(p,{prop:"phone",label:"手机号","min-width":"120"}),l(p,{prop:"email",label:"邮箱","min-width":"180"}),l(p,{prop:"role",label:"角色","min-width":"120"},{default:a(({row:t})=>[l(U,{type:t.role==="系统管理员"?"danger":t.role==="社区管理员"?"primary":t.role==="网格员"?"warning":t.role==="便民服务人员"?"success":t.role==="养老服务专员"?"info":t.role==="文化活动专员"?"success":t.role==="环境监测员"?"warning":t.role==="志愿服务管理员"?"primary":t.role==="社区医生"?"success":"default"},{default:a(()=>[s(R(X(t.role)),1)]),_:2},1032,["type"])]),_:1}),l(p,{prop:"status",label:"状态",width:"100"},{default:a(({row:t})=>[l(Te,{"model-value":t.status,"active-value":"active","inactive-value":"inactive",onClick:()=>me(t)},null,8,["model-value","onClick"])]),_:1}),l(p,{prop:"createTime",label:"创建时间","min-width":"180"}),l(p,{label:"操作",width:"120"},{default:a(({row:t})=>[l(Le,null,{dropdown:a(()=>[l(Ce,null,{default:a(()=>[l(M,{onClick:x=>re(t)},{default:a(()=>e[26]||(e[26]=[s("编辑")])),_:2,__:[26]},1032,["onClick"]),l(M,{onClick:x=>xe(t)},{default:a(()=>e[27]||(e[27]=[s("权限")])),_:2,__:[27]},1032,["onClick"]),l(M,{divided:"",onClick:x=>de(t),style:{color:"red"}},{default:a(()=>e[28]||(e[28]=[s("删除")])),_:2,__:[28]},1032,["onClick"])]),_:2},1024)]),default:a(()=>[l(m,{link:""},{default:a(()=>e[25]||(e[25]=[s("更多")])),_:1,__:[25]})]),_:2},1024)]),_:1})]),_:1},8,["data"]),y("div",Ne,[l(Ue,{"current-page":_.value,"onUpdate:currentPage":e[6]||(e[6]=t=>_.value=t),"page-size":h.value,"onUpdate:pageSize":e[7]||(e[7]=t=>h.value=t),"page-sizes":[10,20,50,100],total:$.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:ge,onCurrentChange:ce},null,8,["current-page","page-size","total"])])]),_:1}),l(I,{modelValue:b.value,"onUpdate:modelValue":e[15]||(e[15]=t=>b.value=t),title:T.value==="add"?"新增用户":"编辑用户",width:"500px"},{footer:a(()=>[y("span",Ae,[l(m,{onClick:e[14]||(e[14]=t=>b.value=!1)},{default:a(()=>e[31]||(e[31]=[s("取消")])),_:1,__:[31]}),l(m,{type:"primary",onClick:pe},{default:a(()=>e[32]||(e[32]=[s("确定")])),_:1,__:[32]})])]),default:a(()=>[l(H,{ref_key:"userFormRef",ref:P,model:u,rules:we,"label-width":"80px"},{default:a(()=>[l(c,{label:"用户名",prop:"username"},{default:a(()=>[l(d,{modelValue:u.username,"onUpdate:modelValue":e[8]||(e[8]=t=>u.username=t),placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1}),l(c,{label:"姓名",prop:"name"},{default:a(()=>[l(d,{modelValue:u.name,"onUpdate:modelValue":e[9]||(e[9]=t=>u.name=t),placeholder:"请输入姓名"},null,8,["modelValue"])]),_:1}),l(c,{label:"手机号",prop:"phone"},{default:a(()=>[l(d,{modelValue:u.phone,"onUpdate:modelValue":e[10]||(e[10]=t=>u.phone=t),placeholder:"请输入手机号"},null,8,["modelValue"])]),_:1}),l(c,{label:"邮箱",prop:"email"},{default:a(()=>[l(d,{modelValue:u.email,"onUpdate:modelValue":e[11]||(e[11]=t=>u.email=t),placeholder:"请输入邮箱"},null,8,["modelValue"])]),_:1}),l(c,{label:"角色",prop:"role"},{default:a(()=>[l(F,{modelValue:u.role,"onUpdate:modelValue":e[12]||(e[12]=t=>u.role=t),placeholder:"请选择角色"},{default:a(()=>[(v(),N(ae,null,ne(q,t=>l(L,{key:t.value,label:t.label,value:t.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),l(c,{label:"状态",prop:"status"},{default:a(()=>[l(Se,{modelValue:u.status,"onUpdate:modelValue":e[13]||(e[13]=t=>u.status=t)},{default:a(()=>[l(Q,{label:"active"},{default:a(()=>e[29]||(e[29]=[s("启用")])),_:1,__:[29]}),l(Q,{label:"inactive"},{default:a(()=>e[30]||(e[30]=[s("禁用")])),_:1,__:[30]})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),l(I,{modelValue:k.value,"onUpdate:modelValue":e[17]||(e[17]=t=>k.value=t),title:"分配权限",width:"400px"},{footer:a(()=>[l(m,{onClick:e[16]||(e[16]=t=>k.value=!1)},{default:a(()=>e[33]||(e[33]=[s("取消")])),_:1,__:[33]}),l(m,{type:"primary",onClick:Ve},{default:a(()=>e[34]||(e[34]=[s("保存")])),_:1,__:[34]})]),default:a(()=>[l(ee,{data:O.value,"show-checkbox":"","node-key":"id","default-checked-keys":he.value,props:{label:"name",children:"children"},ref_key:"userPermissionTreeRef",ref:Z},null,8,["data","default-checked-keys"])]),_:1},8,["modelValue"]),l(I,{modelValue:D.value,"onUpdate:modelValue":e[19]||(e[19]=t=>D.value=t),title:"角色管理",width:"800px"},{default:a(()=>[l(qe,{modelValue:B.value,"onUpdate:modelValue":e[18]||(e[18]=t=>B.value=t)},{default:a(()=>[l(le,{label:"角色列表",name:"list"},{default:a(()=>[y("div",Ke,[l(m,{type:"primary",onClick:fe},{default:a(()=>[l(E,null,{default:a(()=>[l(A(oe))]),_:1}),e[35]||(e[35]=s("新增角色 "))]),_:1,__:[35]})]),l(J,{data:C.value,border:"",style:{width:"100%"}},{default:a(()=>[l(p,{prop:"name",label:"角色名称"}),l(p,{prop:"code",label:"角色编码"}),l(p,{prop:"description",label:"描述"}),l(p,{prop:"createTime",label:"创建时间"}),l(p,{label:"操作",width:"200"},{default:a(({row:t})=>[y("div",Oe,[l(m,{type:"primary",link:"",onClick:x=>_e(t)},{default:a(()=>e[36]||(e[36]=[s("编辑")])),_:2,__:[36]},1032,["onClick"]),l(m,{type:"primary",link:"",onClick:x=>ye(t)},{default:a(()=>e[37]||(e[37]=[s("权限")])),_:2,__:[37]},1032,["onClick"]),l(m,{type:"danger",link:"",onClick:x=>be(t)},{default:a(()=>e[38]||(e[38]=[s("删除")])),_:2,__:[38]},1032,["onClick"])])]),_:1})]),_:1},8,["data"])]),_:1}),l(le,{label:"权限配置",name:"permission"},{default:a(()=>[l(ee,{ref_key:"permissionTreeRef",ref:se,data:O.value,"show-checkbox":"","node-key":"id","default-checked-keys":W.value,props:{label:"name",children:"children"}},null,8,["data","default-checked-keys"])]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])])}}}),He=Fe(We,[["__scopeId","data-v-d73f4a85"]]);export{He as default};
