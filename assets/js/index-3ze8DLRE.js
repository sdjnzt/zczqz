import{d as te,a as x,i as X,w as ge,e as k,k as n,l as de,z as h,j as e,r as u,Z as ke,b as t,m as J,a7 as ie,q as d,P as ce,c as $,n as we,t as T,v as De,F as L,f as E,J as Te,K as me,h as ee,L as Ve,aq as pe,y as he,ar as Ce,as as xe,o as s,Y as ve,at as re,W as K,Q as oe,A as fe,au as Fe,s as $e,av as Ne,aw as Me,ax as Ue,ay as Re,az as ze,aa as Ie}from"./vendor-iaJEqiR6.js";import{_ as le}from"./index-CLUnicPH.js";const Je={class:"document-list"},Qe={class:"filter-container"},We={class:"search-row"},Ze={class:"btn-group"},Le={class:"filter-items"},Se={class:"filter-row"},Ye={key:0,class:"filter-tags"},He={class:"document-title"},je={class:"title-text"},qe={class:"table-actions"},Ae={class:"pagination-container"},Oe={key:1,class:"empty-tip"},Ee=te({__name:"DocumentList",props:{listData:{type:Array,required:!0},loading:{type:Boolean,default:!1},type:{type:String,default:"pending",validator:_=>["pending","processed","created"].includes(_)}},emits:["view","handle","transfer","revoke","track"],setup(_,{emit:Y}){const F=_,z=Y,C=x(""),N=x(""),i=x(""),r=x([]),g=x(1),b=x(10),I=x(!1),O=X(()=>N.value!==""||i.value!==""||r.value&&r.value.length===2),j=[{label:"通知",value:"通知"},{label:"请示",value:"请示"},{label:"报告",value:"报告"},{label:"决定",value:"决定"},{label:"计划",value:"计划"},{label:"函",value:"函"},{label:"会议纪要",value:"会议纪要"}],H=[{label:"特急",value:"特急"},{label:"急",value:"急"},{label:"平件",value:"平件"}],f=o=>({通知:"",请示:"success",报告:"info",决定:"danger",计划:"warning",函:"",会议纪要:"info"})[o]||"",Q=o=>({待审批:"warning",待处理:"warning",已审批:"success",已退回:"danger",流转中:"info",已完成:"success"})[o]||"",Z=o=>{if(!o)return!1;const l=new Date,v=new Date(o),A=Math.ceil((v.getTime()-l.getTime())/(1e3*60*60*24));return A>=0&&A<=3},w=o=>{if(!o)return!1;const l=new Date,v=new Date(o);return l>v},S=X(()=>{let o=[...F.listData];if(C.value){const l=C.value.toLowerCase();o=o.filter(v=>v.title.toLowerCase().includes(l)||v.docNumber&&v.docNumber.toLowerCase().includes(l))}if(N.value&&(o=o.filter(l=>l.type===N.value)),i.value&&(o=o.filter(l=>l.urgency===i.value)),r.value&&r.value.length===2){const l=new Date(r.value[0]),v=new Date(r.value[1]);v.setHours(23,59,59),o=o.filter(A=>{const W=new Date(A.createTime);return W>=l&&W<=v})}return o.slice((g.value-1)*b.value,g.value*b.value)}),V=X(()=>{let o=[...F.listData];if(C.value){const l=C.value.toLowerCase();o=o.filter(v=>v.title.toLowerCase().includes(l)||v.docNumber&&v.docNumber.toLowerCase().includes(l))}if(N.value&&(o=o.filter(l=>l.type===N.value)),i.value&&(o=o.filter(l=>l.urgency===i.value)),r.value&&r.value.length===2){const l=new Date(r.value[0]),v=new Date(r.value[1]);v.setHours(23,59,59),o=o.filter(A=>{const W=new Date(A.createTime);return W>=l&&W<=v})}return o.length});ge(()=>F.listData,()=>{g.value=1},{deep:!0});const a=()=>{g.value=1},M=()=>{g.value=1},p=()=>{C.value="",N.value="",i.value="",r.value=[],g.value=1,I.value=!1},D=o=>{U(o)},U=o=>{z("view",o)},m=o=>{z("handle",o)},B=o=>{z("transfer",o)},q=o=>{z("revoke",o)},P=o=>{z("track",o)};return(o,l)=>{const v=u("el-icon"),A=u("el-input"),W=u("el-button"),G=u("el-option"),ae=u("el-select"),se=u("el-date-picker"),y=u("el-tag"),R=u("el-table-column"),_e=u("el-table"),be=u("el-pagination"),ye=Te("loading");return s(),k("div",Je,[n("div",Qe,[n("div",We,[e(A,{modelValue:C.value,"onUpdate:modelValue":l[0]||(l[0]=c=>C.value=c),placeholder:"搜索公文标题或编号",class:"search-input",clearable:"",onKeyup:ke(a,["enter"])},{prefix:t(()=>[e(v,null,{default:t(()=>[e(J(ie))]),_:1})]),_:1},8,["modelValue"]),n("div",Ze,[e(W,{type:"primary",onClick:a,class:"action-btn search-btn"},{default:t(()=>[e(v,null,{default:t(()=>[e(J(ie))]),_:1}),l[10]||(l[10]=d(" 搜索 "))]),_:1,__:[10]}),e(W,{onClick:p,class:"action-btn"},{default:t(()=>[e(v,null,{default:t(()=>[e(J(ce))]),_:1}),l[11]||(l[11]=d(" 重置 "))]),_:1,__:[11]})]),e(W,{type:I.value?"primary":"default",plain:!I.value,onClick:l[1]||(l[1]=c=>I.value=!I.value),class:"action-btn filter-toggle-btn"},{default:t(()=>[e(v,{class:"filter-icon"},{default:t(()=>[(s(),$(we(I.value?"ArrowUp":"Filter")))]),_:1}),d(" "+T(I.value?"收起筛选":"高级筛选"),1)]),_:1},8,["type","plain"])]),de(n("div",Le,[n("div",Se,[e(ae,{modelValue:N.value,"onUpdate:modelValue":l[2]||(l[2]=c=>N.value=c),placeholder:"公文类型",clearable:"",onChange:M},{default:t(()=>[(s(),k(L,null,E(j,c=>e(G,{key:c.value,label:c.label,value:c.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"]),e(ae,{modelValue:i.value,"onUpdate:modelValue":l[3]||(l[3]=c=>i.value=c),placeholder:"紧急程度",clearable:"",onChange:M},{default:t(()=>[(s(),k(L,null,E(H,c=>e(G,{key:c.value,label:c.label,value:c.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"]),e(se,{modelValue:r.value,"onUpdate:modelValue":l[4]||(l[4]=c=>r.value=c),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"YYYY/MM/DD","value-format":"YYYY-MM-DD",style:{width:"320px"},onChange:M},null,8,["modelValue"])])],512),[[De,I.value]]),O.value?(s(),k("div",Ye,[N.value?(s(),$(y,{key:0,closable:"",onClose:l[5]||(l[5]=c=>N.value="")},{default:t(()=>[d(" 类型: "+T(N.value),1)]),_:1})):h("",!0),i.value?(s(),$(y,{key:1,closable:"",onClose:l[6]||(l[6]=c=>i.value="")},{default:t(()=>[d(" 紧急程度: "+T(i.value),1)]),_:1})):h("",!0),r.value&&r.value.length===2?(s(),$(y,{key:2,closable:"",onClose:l[7]||(l[7]=c=>r.value=[])},{default:t(()=>[d(" 时间范围: "+T(r.value[0])+" 至 "+T(r.value[1]),1)]),_:1})):h("",!0)])):h("",!0)]),de((s(),$(_e,{data:S.value,border:"",style:{width:"100%"},"header-cell-style":{background:"#f5f7fa",color:"#606266"},onRowClick:D},{default:t(()=>[e(R,{label:"公文标题","min-width":"250","show-overflow-tooltip":""},{default:t(({row:c})=>[n("div",He,[c.urgency==="特急"?(s(),$(y,{key:0,type:"danger",effect:"dark",size:"small"},{default:t(()=>l[12]||(l[12]=[d("特急")])),_:1,__:[12]})):c.urgency==="急"?(s(),$(y,{key:1,type:"warning",size:"small"},{default:t(()=>l[13]||(l[13]=[d("急")])),_:1,__:[13]})):h("",!0),n("span",je,T(c.title),1)])]),_:1}),e(R,{prop:"docNumber",label:"文号",width:"150","show-overflow-tooltip":""}),e(R,{prop:"type",label:"类型",width:"100"},{default:t(({row:c})=>[e(y,{type:f(c.type),size:"small"},{default:t(()=>[d(T(c.type),1)]),_:2},1032,["type"])]),_:1}),_.type==="pending"?(s(),k(L,{key:0},[e(R,{prop:"sender",label:"发文人",width:"100"}),e(R,{prop:"department",label:"发文部门",width:"120"}),e(R,{prop:"createTime",label:"发文时间",width:"160"}),e(R,{prop:"deadline",label:"办理期限",width:"100"},{default:t(({row:c})=>[n("span",{class:me(["deadline",Z(c.deadline)?"near-deadline":"",w(c.deadline)?"overdue":""])},T(c.deadline),3)]),_:1})],64)):_.type==="processed"?(s(),k(L,{key:1},[e(R,{prop:"sender",label:"发文人",width:"100"}),e(R,{prop:"department",label:"发文部门",width:"120"}),e(R,{prop:"createTime",label:"发文时间",width:"160"}),e(R,{prop:"processTime",label:"办理时间",width:"160"})],64)):_.type==="created"?(s(),k(L,{key:2},[e(R,{prop:"receiver",label:"接收部门",width:"120"}),e(R,{prop:"createTime",label:"发文时间",width:"160"}),e(R,{prop:"currentHandler",label:"当前处理人",width:"110"}),e(R,{prop:"currentDepartment",label:"当前部门",width:"120"})],64)):h("",!0),e(R,{prop:"status",label:"状态",width:"100"},{default:t(({row:c})=>[e(y,{type:Q(c.status),size:"small"},{default:t(()=>[d(T(c.status),1)]),_:2},1032,["type"])]),_:1}),e(R,{label:"操作","min-width":"180",fixed:"right"},{default:t(({row:c})=>[n("div",qe,[e(W,{type:"primary",size:"small",onClick:ee(ne=>U(c),["stop"]),class:"btn-view"},{default:t(()=>[e(v,null,{default:t(()=>[e(J(Ve))]),_:1}),l[14]||(l[14]=d(" 查看 "))]),_:2,__:[14]},1032,["onClick"]),_.type==="pending"?(s(),k(L,{key:0},[e(W,{type:"success",size:"small",onClick:ee(ne=>m(c),["stop"]),class:"btn-action"},{default:t(()=>[e(v,null,{default:t(()=>[e(J(pe))]),_:1}),l[15]||(l[15]=d(" 处理 "))]),_:2,__:[15]},1032,["onClick"]),e(W,{type:"info",size:"small",onClick:ee(ne=>B(c),["stop"]),class:"btn-action"},{default:t(()=>[e(v,null,{default:t(()=>[e(J(he))]),_:1}),l[16]||(l[16]=d(" 转发 "))]),_:2,__:[16]},1032,["onClick"])],64)):h("",!0),_.type==="created"&&c.status!=="已完成"?(s(),$(W,{key:1,type:"warning",size:"small",onClick:ee(ne=>q(c),["stop"]),class:"btn-action"},{default:t(()=>[e(v,null,{default:t(()=>[e(J(Ce))]),_:1}),l[17]||(l[17]=d(" 撤回 "))]),_:2,__:[17]},1032,["onClick"])):h("",!0),e(W,{plain:"",size:"small",onClick:ee(ne=>P(c),["stop"]),class:"btn-track"},{default:t(()=>[e(v,null,{default:t(()=>[e(J(xe))]),_:1}),l[18]||(l[18]=d(" 跟踪 "))]),_:2,__:[18]},1032,["onClick"])])]),_:1})]),_:1},8,["data"])),[[ye,_.loading]]),n("div",Ae,[S.value.length>0?(s(),$(be,{key:0,"current-page":g.value,"onUpdate:currentPage":l[8]||(l[8]=c=>g.value=c),"page-size":b.value,"onUpdate:pageSize":l[9]||(l[9]=c=>b.value=c),"page-sizes":[10,20,30,50],total:V.value,layout:"total, sizes, prev, pager, next, jumper",background:""},null,8,["current-page","page-size","total"])):(s(),k("div",Oe," 暂无相关公文 "))])])}}}),ue=le(Ee,[["__scopeId","data-v-32624213"]]),Be={class:"document-form"},Ke=te({__name:"DocumentForm",emits:["submit","cancel"],setup(_,{emit:Y}){const F=Y,z=x(),C=x([]),N=[{label:"通知",value:"通知"},{label:"请示",value:"请示"},{label:"报告",value:"报告"},{label:"决定",value:"决定"},{label:"计划",value:"计划"},{label:"函",value:"函"},{label:"会议纪要",value:"会议纪要"}],i=[{label:"镇政府办",value:"镇政府办"},{label:"财政所",value:"财政所"},{label:"民政所",value:"民政所"},{label:"社会保障所",value:"社会保障所"},{label:"农业农村办公室",value:"农业农村办公室"},{label:"城建办公室",value:"城建办公室"},{label:"综治办公室",value:"综治办公室"},{label:"安监办",value:"安监办"},{label:"环保办",value:"环保办"},{label:"文教中心",value:"文教中心"}],r=ve({title:"",type:"",receiver:"",urgency:"平件",content:"",attachments:[]}),g={title:[{required:!0,message:"请输入公文标题",trigger:"blur"},{min:2,max:100,message:"标题长度在 2 到 100 个字符",trigger:"blur"}],type:[{required:!0,message:"请选择公文类型",trigger:"change"}],receiver:[{required:!0,message:"请选择接收部门",trigger:"change"}],urgency:[{required:!0,message:"请选择紧急程度",trigger:"change"}],content:[{required:!0,message:"请输入公文内容",trigger:"blur"},{min:5,max:2e3,message:"内容长度在 5 到 2000 个字符",trigger:"blur"}]},b=(H,f)=>{C.value=f,r.attachments=f.map(Q=>({name:Q.name,url:URL.createObjectURL(Q.raw)}))},I=(H,f)=>{C.value=f,r.attachments=f.map(Q=>({name:Q.name,url:URL.createObjectURL(Q.raw)}))},O=async()=>{z.value&&await z.value.validate(H=>{H&&F("submit",{...r})})},j=()=>{F("cancel")};return(H,f)=>{const Q=u("el-input"),Z=u("el-form-item"),w=u("el-option"),S=u("el-select"),V=u("el-radio"),a=u("el-radio-group"),M=u("el-icon"),p=u("el-upload"),D=u("el-button"),U=u("el-form");return s(),k("div",Be,[e(U,{ref_key:"formRef",ref:z,model:r,rules:g,"label-width":"100px","label-position":"right"},{default:t(()=>[e(Z,{label:"公文标题",prop:"title"},{default:t(()=>[e(Q,{modelValue:r.title,"onUpdate:modelValue":f[0]||(f[0]=m=>r.title=m),placeholder:"请输入公文标题",maxlength:"100","show-word-limit":""},null,8,["modelValue"])]),_:1}),e(Z,{label:"公文类型",prop:"type"},{default:t(()=>[e(S,{modelValue:r.type,"onUpdate:modelValue":f[1]||(f[1]=m=>r.type=m),placeholder:"请选择公文类型",style:{width:"100%"}},{default:t(()=>[(s(),k(L,null,E(N,m=>e(w,{key:m.value,label:m.label,value:m.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),e(Z,{label:"接收部门",prop:"receiver"},{default:t(()=>[e(S,{modelValue:r.receiver,"onUpdate:modelValue":f[2]||(f[2]=m=>r.receiver=m),placeholder:"请选择接收部门",style:{width:"100%"}},{default:t(()=>[(s(),k(L,null,E(i,m=>e(w,{key:m.value,label:m.label,value:m.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),e(Z,{label:"紧急程度",prop:"urgency"},{default:t(()=>[e(a,{modelValue:r.urgency,"onUpdate:modelValue":f[3]||(f[3]=m=>r.urgency=m)},{default:t(()=>[e(V,{label:"平件"},{default:t(()=>f[5]||(f[5]=[d("平件")])),_:1,__:[5]}),e(V,{label:"急"},{default:t(()=>f[6]||(f[6]=[d("急件")])),_:1,__:[6]}),e(V,{label:"特急"},{default:t(()=>f[7]||(f[7]=[d("特急")])),_:1,__:[7]})]),_:1},8,["modelValue"])]),_:1}),e(Z,{label:"公文内容",prop:"content"},{default:t(()=>[e(Q,{modelValue:r.content,"onUpdate:modelValue":f[4]||(f[4]=m=>r.content=m),type:"textarea",placeholder:"请输入公文内容",rows:8,maxlength:"2000","show-word-limit":""},null,8,["modelValue"])]),_:1}),e(Z,{label:"附件"},{default:t(()=>[e(p,{action:"#","list-type":"picture-card","auto-upload":!1,"file-list":C.value,"on-change":b,"on-remove":I,limit:5},{default:t(()=>[e(M,null,{default:t(()=>[e(J(re))]),_:1})]),_:1},8,["file-list"])]),_:1}),e(Z,null,{default:t(()=>[e(D,{type:"primary",onClick:O},{default:t(()=>f[8]||(f[8]=[d("提交")])),_:1,__:[8]}),e(D,{onClick:j},{default:t(()=>f[9]||(f[9]=[d("取消")])),_:1,__:[9]})]),_:1})]),_:1},8,["model"])])}}}),Pe=le(Ke,[["__scopeId","data-v-fe263fc8"]]),Ge={class:"document-handle"},Xe={key:0,class:"document-content"},et={class:"content-body"},tt={key:1,class:"document-attachments"},lt={class:"attachment-list"},at={class:"common-comments"},nt=te({__name:"DocumentHandle",props:{document:{type:Object,required:!0},viewOnly:{type:Boolean,default:!1}},emits:["submit","cancel"],setup(_,{emit:Y}){const F=_,z=Y,C=[{label:"镇政府办",value:"镇政府办"},{label:"财政所",value:"财政所"},{label:"民政所",value:"民政所"},{label:"社会保障所",value:"社会保障所"},{label:"农业农村办公室",value:"农业农村办公室"},{label:"城建办公室",value:"城建办公室"},{label:"综治办公室",value:"综治办公室"},{label:"安监办",value:"安监办"},{label:"环保办",value:"环保办"},{label:"文教中心",value:"文教中心"},{label:"卫生院",value:"卫生院"},{label:"水务局",value:"水务局"},{label:"市场监管所",value:"市场监管所"},{label:"安全生产委员会",value:"安全生产委员会"},{label:"文化旅游局",value:"文化旅游局"},{label:"教育科",value:"教育科"}],N=["同意，按程序办理","同意，请抓紧办理","同意，并请及时反馈处理结果","请修改后再次提交","不同意，请重新评估后再提交","请相关部门协调处理","转发至相关部门研究讨论","请提供更多详细资料","已收悉，按要求办理"],i=ve({action:"approve",transferTo:"",comment:"",needFeedback:!1,deadline:"",priority:"普通"}),r=x(null),g=x(""),b=X(()=>!0),I=X(()=>!F.viewOnly),O=X(()=>i.action==="transfer"||i.action==="approve"),j=V=>({通知:"",请示:"success",报告:"info",决定:"danger",计划:"warning",函:"",会议纪要:"info",方案:"warning",意见:"info"})[V]||"",H=V=>({待审批:"warning",待处理:"warning",已审批:"success",已退回:"danger",流转中:"info",已完成:"success"})[V]||"",f=V=>{if(!V)return!1;const a=new Date,M=new Date(V),p=Math.ceil((M.getTime()-a.getTime())/(1e3*60*60*24));return p>=0&&p<=3},Q=V=>{if(!V)return!1;const a=new Date,M=new Date(V);return a>M},Z=()=>{g.value&&(i.comment=g.value,g.value="")},w=()=>{if(i.action==="transfer"&&!i.transferTo){K.warning("请选择转发部门");return}if(i.needFeedback&&!i.deadline){const V=new Date;V.setDate(V.getDate()+3),i.deadline=V.toISOString().split("T")[0]}z("submit",{...i})},S=()=>{z("cancel")};return(V,a)=>{const M=u("el-descriptions-item"),p=u("el-tag"),D=u("el-descriptions"),U=u("el-icon"),m=u("el-link"),B=u("el-card"),q=u("el-radio"),P=u("el-radio-group"),o=u("el-form-item"),l=u("el-option"),v=u("el-select"),A=u("el-switch"),W=u("el-date-picker"),G=u("el-button"),ae=u("el-input"),se=u("el-form");return s(),k("div",Ge,[e(B,{class:"document-info"},{header:t(()=>a[7]||(a[7]=[n("div",{class:"card-header"},[n("span",null,"公文信息")],-1)])),default:t(()=>[e(D,{column:2,border:""},{default:t(()=>[e(M,{label:"标题"},{default:t(()=>[d(T(_.document.title),1)]),_:1}),e(M,{label:"文号"},{default:t(()=>[d(T(_.document.docNumber||"暂无"),1)]),_:1}),e(M,{label:"类型"},{default:t(()=>[e(p,{type:j(_.document.type),size:"small"},{default:t(()=>[d(T(_.document.type),1)]),_:1},8,["type"])]),_:1}),e(M,{label:"紧急程度"},{default:t(()=>[_.document.urgency==="特急"?(s(),$(p,{key:0,type:"danger",effect:"dark",size:"small"},{default:t(()=>a[8]||(a[8]=[d("特急")])),_:1,__:[8]})):_.document.urgency==="急"?(s(),$(p,{key:1,type:"warning",size:"small"},{default:t(()=>a[9]||(a[9]=[d("急")])),_:1,__:[9]})):(s(),$(p,{key:2,size:"small"},{default:t(()=>a[10]||(a[10]=[d("平件")])),_:1,__:[10]}))]),_:1}),e(M,{label:"发文人"},{default:t(()=>[d(T(_.document.sender||"暂无"),1)]),_:1}),e(M,{label:"发文部门"},{default:t(()=>[d(T(_.document.department||"暂无"),1)]),_:1}),e(M,{label:"发文时间"},{default:t(()=>[d(T(_.document.createTime||"暂无"),1)]),_:1}),e(M,{label:"状态"},{default:t(()=>[e(p,{type:H(_.document.status),size:"small"},{default:t(()=>[d(T(_.document.status),1)]),_:1},8,["type"])]),_:1}),_.document.deadline?(s(),$(M,{key:0,label:"办理期限"},{default:t(()=>[n("span",{class:me(["deadline",f(_.document.deadline)?"near-deadline":"",Q(_.document.deadline)?"overdue":""])},T(_.document.deadline),3)]),_:1})):h("",!0)]),_:1}),_.document.content?(s(),k("div",Xe,[a[11]||(a[11]=n("div",{class:"content-title"},"公文内容：",-1)),n("div",et,T(_.document.content),1)])):h("",!0),_.document.attachments&&_.document.attachments.length>0?(s(),k("div",tt,[a[12]||(a[12]=n("div",{class:"attachment-title"},"附件：",-1)),n("div",lt,[(s(!0),k(L,null,E(_.document.attachments,(y,R)=>(s(),$(m,{key:R,type:"primary",href:y.url,target:"_blank",underline:!1},{default:t(()=>[e(U,null,{default:t(()=>[e(J(oe))]),_:1}),d(" "+T(y.name),1)]),_:2},1032,["href"]))),128))])])):h("",!0)]),_:1}),I.value?(s(),$(B,{key:0,class:"handle-form"},{header:t(()=>a[13]||(a[13]=[n("div",{class:"card-header"},[n("span",null,"处理意见")],-1)])),default:t(()=>[e(se,{ref_key:"formRef",ref:r,model:i,"label-width":"100px"},{default:t(()=>[e(o,{label:"处理动作",prop:"action"},{default:t(()=>[e(P,{modelValue:i.action,"onUpdate:modelValue":a[0]||(a[0]=y=>i.action=y)},{default:t(()=>[e(q,{label:"approve"},{default:t(()=>a[14]||(a[14]=[d("同意")])),_:1,__:[14]}),e(q,{label:"reject"},{default:t(()=>a[15]||(a[15]=[d("不同意")])),_:1,__:[15]}),b.value?(s(),$(q,{key:0,label:"transfer"},{default:t(()=>a[16]||(a[16]=[d("转发")])),_:1,__:[16]})):h("",!0)]),_:1},8,["modelValue"])]),_:1}),i.action==="transfer"?(s(),$(o,{key:0,label:"转发至",prop:"transferTo"},{default:t(()=>[e(v,{modelValue:i.transferTo,"onUpdate:modelValue":a[1]||(a[1]=y=>i.transferTo=y),placeholder:"请选择转发部门",style:{width:"100%"}},{default:t(()=>[(s(),k(L,null,E(C,y=>e(l,{key:y.value,label:y.label,value:y.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1})):h("",!0),O.value?(s(),k(L,{key:1},[e(o,{label:"优先级",prop:"priority"},{default:t(()=>[e(P,{modelValue:i.priority,"onUpdate:modelValue":a[2]||(a[2]=y=>i.priority=y)},{default:t(()=>[e(q,{label:"普通"},{default:t(()=>a[17]||(a[17]=[d("普通")])),_:1,__:[17]}),e(q,{label:"优先"},{default:t(()=>a[18]||(a[18]=[d("优先")])),_:1,__:[18]}),e(q,{label:"紧急"},{default:t(()=>a[19]||(a[19]=[d("紧急")])),_:1,__:[19]})]),_:1},8,["modelValue"])]),_:1}),e(o,{label:"需要反馈"},{default:t(()=>[e(A,{modelValue:i.needFeedback,"onUpdate:modelValue":a[3]||(a[3]=y=>i.needFeedback=y)},null,8,["modelValue"])]),_:1}),i.needFeedback?(s(),$(o,{key:0,label:"反馈期限"},{default:t(()=>[e(W,{modelValue:i.deadline,"onUpdate:modelValue":a[4]||(a[4]=y=>i.deadline=y),type:"date",placeholder:"选择反馈期限",format:"YYYY/MM/DD","value-format":"YYYY-MM-DD","disabled-date":y=>y<new Date,style:{width:"100%"}},null,8,["modelValue","disabled-date"])]),_:1})):h("",!0)],64)):h("",!0),e(o,{label:"常用意见"},{default:t(()=>[n("div",at,[e(v,{modelValue:g.value,"onUpdate:modelValue":a[5]||(a[5]=y=>g.value=y),placeholder:"选择常用意见",clearable:"",style:{width:"100%"}},{default:t(()=>[(s(),k(L,null,E(N,(y,R)=>e(l,{key:R,label:y,value:y},null,8,["label","value"])),64))]),_:1},8,["modelValue"]),e(G,{type:"primary",plain:"",onClick:Z,disabled:!g.value},{default:t(()=>a[20]||(a[20]=[d(" 插入 ")])),_:1,__:[20]},8,["disabled"])])]),_:1}),e(o,{label:"处理意见",prop:"comment"},{default:t(()=>[e(ae,{modelValue:i.comment,"onUpdate:modelValue":a[6]||(a[6]=y=>i.comment=y),type:"textarea",rows:"4",placeholder:"请输入处理意见",maxlength:"500","show-word-limit":""},null,8,["modelValue"])]),_:1}),e(o,null,{default:t(()=>[e(G,{type:"primary",onClick:w},{default:t(()=>a[21]||(a[21]=[d("提交")])),_:1,__:[21]}),e(G,{onClick:S},{default:t(()=>a[22]||(a[22]=[d("取消")])),_:1,__:[22]})]),_:1})]),_:1},8,["model"])]),_:1})):h("",!0)])}}}),ot=le(nt,[["__scopeId","data-v-726ec2f8"]]),st={class:"document-track"},ut={class:"track-header"},rt={class:"track-action"},dt={class:"track-user"},it={class:"track-content"},ct={key:0},mt={key:1},pt={key:2},vt={key:0,class:"track-comment"},ft={class:"comment-content"},_t={key:1,class:"track-attachments"},bt={class:"attachment-list"},yt={key:0,class:"empty-tip"},gt=te({__name:"DocumentTrack",props:{documentId:{type:String,required:!0}},setup(_){const Y=_,F=x([{id:"1",documentId:"1",action:"create",userName:"张明",userRole:"科员",fromDept:"政府办公室",time:"2025-06-15 09:30:45",content:"创建了公文《关于加强城镇基层治理的通知》",attachments:[]},{id:"2",documentId:"1",action:"receive",userName:"李强",userRole:"主任",fromDept:"政府办公室",time:"2025-06-15 10:15:22",content:"收到公文《关于加强城镇基层治理的通知》",attachments:[]},{id:"3",documentId:"1",action:"transfer",userName:"李强",userRole:"主任",fromDept:"政府办公室",toDept:"民政所",time:"2025-06-15 11:30:15",content:"转发公文至民政所",comment:"请民政所提供相关意见",attachments:[]},{id:"4",documentId:"1",action:"receive",userName:"王佳",userRole:"所长",fromDept:"民政所",time:"2025-06-15 13:45:30",content:"收到公文《关于加强城镇基层治理的通知》",attachments:[]},{id:"5",documentId:"1",action:"approve",userName:"王佳",userRole:"所长",fromDept:"民政所",time:"2025-06-16 09:20:10",content:"审批通过公文",comment:"同意该通知内容，建议加强社区网格员管理，提高基层治理能力。",attachments:[{name:"社区网格化管理实施方案.docx",url:"#"},{name:"基层治理工作计划.xlsx",url:"#"}]}]),z=g=>({create:"primary",receive:"info",transfer:"warning",approve:"success",reject:"danger",revoke:"info",complete:"success"})[g]||"info",C=g=>({create:pe,receive:oe,transfer:ze,approve:Re,reject:Ue,revoke:Me,complete:Ne})[g]||oe,N=g=>({create:"#409EFF",receive:"#909399",transfer:"#E6A23C",approve:"#67C23A",reject:"#F56C6C",revoke:"#909399",complete:"#67C23A"})[g]||"#909399",i=g=>({create:"创建公文",receive:"接收公文",transfer:"转发公文",approve:"审批通过",reject:"退回公文",revoke:"撤回公文",complete:"办结完成"})[g]||g,r=()=>{Y.documentId!=="1"&&(F.value=[{id:"1",documentId:Y.documentId,action:"create",userName:"张明",userRole:"科员",fromDept:"政府办公室",time:"2025-06-16 14:30:45",content:"创建了公文",attachments:[]},{id:"2",documentId:Y.documentId,action:"receive",userName:"李强",userRole:"主任",fromDept:"政府办公室",time:"2025-06-16 15:15:22",content:"收到公文",attachments:[]}])};return fe(()=>{r()}),(g,b)=>{const I=u("el-icon"),O=u("el-link"),j=u("el-card"),H=u("el-timeline-item"),f=u("el-timeline"),Q=u("el-empty"),Z=u("el-divider");return s(),k("div",st,[e(f,null,{default:t(()=>[(s(!0),k(L,null,E(F.value,(w,S)=>(s(),$(H,{key:S,timestamp:w.time,type:z(w.action),icon:C(w.action),color:N(w.action)},{default:t(()=>[e(j,{class:"track-card"},{default:t(()=>[n("div",ut,[n("span",rt,T(i(w.action)),1),n("span",dt,[e(I,null,{default:t(()=>[e(J($e))]),_:1}),d(" "+T(w.userName),1)])]),n("div",it,[w.content?(s(),k("p",ct,T(w.content),1)):h("",!0),w.fromDept?(s(),k("p",mt,[b[0]||(b[0]=n("span",{class:"dept-label"},"处理部门：",-1)),d(T(w.fromDept),1)])):h("",!0),w.toDept?(s(),k("p",pt,[b[1]||(b[1]=n("span",{class:"dept-label"},"转发至：",-1)),d(T(w.toDept),1)])):h("",!0)]),w.comment?(s(),k("div",vt,[b[2]||(b[2]=n("div",{class:"comment-title"},"处理意见：",-1)),n("div",ft,T(w.comment),1)])):h("",!0),w.attachments&&w.attachments.length>0?(s(),k("div",_t,[b[3]||(b[3]=n("div",{class:"attachment-title"},"附件：",-1)),n("div",bt,[(s(!0),k(L,null,E(w.attachments,(V,a)=>(s(),$(O,{key:a,type:"primary",href:V.url,target:"_blank",underline:!1},{default:t(()=>[e(I,null,{default:t(()=>[e(J(oe))]),_:1}),d(" "+T(V.name),1)]),_:2},1032,["href"]))),128))])])):h("",!0)]),_:2},1024)]),_:2},1032,["timestamp","type","icon","color"]))),128))]),_:1}),F.value.length===0?(s(),k("div",yt,[e(Q,{description:"暂无流转记录"})])):h("",!0),e(Z,{"content-position":"center"},{default:t(()=>[e(I,null,{default:t(()=>[e(J(Fe))]),_:1}),b[4]||(b[4]=d(" 流程说明 "))]),_:1,__:[4]}),e(j,{class:"process-desc"},{default:t(()=>b[5]||(b[5]=[n("div",{class:"process-title"},"公文流转流程：",-1),n("div",{class:"process-steps"},[n("div",{class:"step"},[n("span",{class:"step-dot",style:{"background-color":"#409EFF"}}),n("span",{class:"step-text"},"创建")]),n("div",{class:"step-line"}),n("div",{class:"step"},[n("span",{class:"step-dot",style:{"background-color":"#E6A23C"}}),n("span",{class:"step-text"},"审核")]),n("div",{class:"step-line"}),n("div",{class:"step"},[n("span",{class:"step-dot",style:{"background-color":"#67C23A"}}),n("span",{class:"step-text"},"审批")]),n("div",{class:"step-line"}),n("div",{class:"step"},[n("span",{class:"step-dot",style:{"background-color":"#909399"}}),n("span",{class:"step-text"},"完成")])],-1),n("div",{class:"process-note"},[n("p",null,"1. 文件由创建人提交后，自动流转至指定部门负责人；"),n("p",null,"2. 部门负责人可对公文进行审核、转发或退回操作；"),n("p",null,"3. 最终审批人对公文进行处理后流程结束；"),n("p",null,"4. 公文创建人可随时查看公文流转状态与处理进度。")],-1)])),_:1,__:[5]})])}}}),kt=le(gt,[["__scopeId","data-v-f4c3c8e8"]]),wt={class:"document-container"},Dt={class:"card-header"},Tt={class:"header-actions"},Vt={class:"floating-actions"},ht=te({__name:"index",setup(_){const Y=x("pending"),F=x(!1),z=x(!1),C=x(!1),N=x(!1),i=x(""),r=x(null),g=x(),b=x([{id:"1",title:"关于加强城镇基层治理的通知",docNumber:"QZFWJ-2025-045",type:"通知",urgency:"急",sender:"张明",department:"政府办公室",createTime:"2025-06-15 09:30:45",deadline:"2025-06-18",status:"待审批"},{id:"2",title:"2025年度农村人居环境整治工作计划",docNumber:"QZFWJ-2025-046",type:"计划",urgency:"特急",sender:"李强",department:"农业农村办公室",createTime:"2025-06-16 10:15:22",deadline:"2025-06-19",status:"待审批"},{id:"3",title:"关于开展防汛安全检查的通知",docNumber:"QZFWJ-2025-047",type:"通知",urgency:"平件",sender:"王佳",department:"应急管理办公室",createTime:"2025-06-16 14:05:37",deadline:"2025-06-23",status:"待处理"},{id:"10",title:"关于开展城前镇2025年度安全生产月活动的通知",docNumber:"QZFWJ-2025-066",type:"通知",urgency:"急",sender:"周琦",department:"安全生产委员会",createTime:"2025-06-17 08:22:15",deadline:"2025-06-20",status:"待审批"},{id:"11",title:"城前镇重点工程项目土地征收补偿方案",docNumber:"QZFWJ-2025-067",type:"方案",urgency:"特急",sender:"赵敏",department:"城建办公室",createTime:"2025-06-17 09:10:45",deadline:"2025-06-21",status:"待审批"},{id:"12",title:"关于统计上报2025年第二季度财政收支情况的通知",docNumber:"QZFWJ-2025-068",type:"通知",urgency:"平件",sender:"钱华",department:"财政所",createTime:"2025-06-17 11:30:22",deadline:"2025-06-25",status:"待处理"}]),I=x([{id:"4",title:"关于做好夏季安全生产工作的通知",docNumber:"QZFWJ-2025-042",type:"通知",urgency:"急",sender:"张明",department:"安监办",createTime:"2025-06-10 11:22:33",processTime:"2025-06-12 09:45:12",status:"已审批",result:"同意"},{id:"5",title:"2025年第二季度财政预算执行情况报告",docNumber:"QZFWJ-2025-043",type:"报告",urgency:"平件",sender:"赵敏",department:"财政所",createTime:"2025-06-08 16:30:25",processTime:"2025-06-11 14:18:05",status:"已审批",result:"同意"},{id:"6",title:"关于调整城前镇村级组织运转经费保障政策的请示",docNumber:"QZFWJ-2025-044",type:"请示",urgency:"急",sender:"刘畅",department:"民政所",createTime:"2025-06-09 09:15:40",processTime:"2025-06-12 16:40:22",status:"已审批",result:"同意并附建议"},{id:"13",title:"城前镇农村公路养护项目验收报告",docNumber:"QZFWJ-2025-038",type:"报告",urgency:"平件",sender:"孙磊",department:"城建办公室",createTime:"2025-06-05 08:40:25",processTime:"2025-06-08 10:12:30",status:"已审批",result:"同意"},{id:"14",title:"关于申请2025年度农村饮水安全工程专项资金的请示",docNumber:"QZFWJ-2025-039",type:"请示",urgency:"急",sender:"杨帆",department:"水务局",createTime:"2025-06-06 10:20:18",processTime:"2025-06-09 15:33:45",status:"已审批",result:"同意"},{id:"15",title:"关于加强城前镇文物保护工作的意见",docNumber:"QZFWJ-2025-040",type:"意见",urgency:"平件",sender:"胡敏",department:"文化旅游局",createTime:"2025-06-07 14:25:32",processTime:"2025-06-10 11:05:18",status:"已退回",result:"需要修改后重新提交"},{id:"16",title:"城前镇2025年度政府信息公开工作要点",docNumber:"QZFWJ-2025-041",type:"通知",urgency:"平件",sender:"郭静",department:"政府办公室",createTime:"2025-06-08 09:18:40",processTime:"2025-06-10 16:22:50",status:"已审批",result:"同意并要求尽快落实"}]),O=x([{id:"7",title:"关于开展农村人居环境整治工作的请示",docNumber:"QZFWJ-2025-048",type:"请示",urgency:"急",receiver:"镇政府办",createTime:"2025-06-17 08:45:12",status:"流转中",currentHandler:"王镇长",currentDepartment:"镇政府办"},{id:"8",title:"关于申请增加社区文化活动经费的报告",docNumber:"QZFWJ-2025-049",type:"报告",urgency:"平件",receiver:"财政所",createTime:"2025-06-17 11:30:45",status:"流转中",currentHandler:"李所长",currentDepartment:"财政所"},{id:"17",title:"关于推进农村集体经济发展的意见",docNumber:"QZFWJ-2025-060",type:"意见",urgency:"平件",receiver:"农业农村办公室",createTime:"2025-06-16 09:20:15",status:"流转中",currentHandler:"陈主任",currentDepartment:"农业农村办公室"},{id:"18",title:"关于申请城前镇老旧小区改造项目资金的请示",docNumber:"QZFWJ-2025-061",type:"请示",urgency:"急",receiver:"财政所",createTime:"2025-06-16 11:05:30",status:"已完成",currentHandler:"已办结",currentDepartment:"财政所"},{id:"19",title:"关于组织开展2025年度农村低保评审工作的请示",docNumber:"QZFWJ-2025-062",type:"请示",urgency:"平件",receiver:"民政所",createTime:"2025-06-15 14:22:38",status:"已退回",currentHandler:"张所长",currentDepartment:"民政所"},{id:"20",title:"城前镇2025年度基础教育质量提升计划",docNumber:"QZFWJ-2025-063",type:"计划",urgency:"平件",receiver:"教育科",createTime:"2025-06-15 16:40:20",status:"已完成",currentHandler:"已办结",currentDepartment:"教育科"}]),j=()=>{z.value=!0},H=p=>{console.log("新建公文表单数据:",p),K.success("公文已创建"),z.value=!1,a()},f=p=>{r.value=p,C.value=!0,i.value="查看公文"},Q=p=>{r.value=p,C.value=!0,i.value="处理公文"},Z=p=>{r.value=p,C.value=!0,i.value="转发公文"},w=p=>{K.info(`模拟撤回公文: ${p.title}`)},S=p=>{r.value=p,N.value=!0},V=p=>{r.value&&(F.value=!0,setTimeout(()=>{const D=r.value.id;if(p.action==="approve"){const U=b.value.findIndex(m=>m.id===D);if(U>-1){const m={...b.value[U]};m.status="已审批",m.result=p.comment?"同意: "+p.comment:"同意",m.processTime=new Date().toLocaleString(),p.needFeedback&&p.deadline&&(m.feedbackRequired=!0,m.feedbackDeadline=p.deadline),p.priority&&p.priority!=="普通"&&(m.priority=p.priority),b.value.splice(U,1),I.value.unshift(m),K.success("公文已审批通过")}}else if(p.action==="reject"){const U=b.value.findIndex(m=>m.id===D);if(U>-1){const m={...b.value[U]};m.status="已退回",m.result=p.comment?"不同意: "+p.comment:"不同意",m.processTime=new Date().toLocaleString(),b.value.splice(U,1),I.value.unshift(m),K.success("公文已退回")}}else if(p.action==="transfer"){const U=p.transferTo?`公文已转发至${p.transferTo}`:"公文已转发";K.success(U)}C.value=!1,F.value=!1},1e3))},a=()=>{F.value=!0,setTimeout(()=>{K.success("数据已更新"),F.value=!1},1e3)},M=()=>{window.scrollTo({top:0,behavior:"smooth"})};return fe(()=>{F.value=!0,setTimeout(()=>{F.value=!1},800)}),(p,D)=>{const U=u("el-icon"),m=u("el-button"),B=u("el-tab-pane"),q=u("el-tabs"),P=u("el-card"),o=u("el-dialog"),l=u("el-tooltip");return s(),k("div",wt,[e(P,{class:"main-card"},{header:t(()=>[n("div",Dt,[D[7]||(D[7]=n("h2",null,"公文流转跟踪",-1)),n("div",Tt,[e(m,{type:"primary",onClick:j,class:"create-btn"},{default:t(()=>[e(U,null,{default:t(()=>[e(J(re))]),_:1}),D[6]||(D[6]=d(" 新建公文 "))]),_:1,__:[6]})])])]),default:t(()=>[e(q,{modelValue:Y.value,"onUpdate:modelValue":D[0]||(D[0]=v=>Y.value=v),class:"document-tabs"},{default:t(()=>[e(B,{label:"待办公文",name:"pending"},{default:t(()=>[e(ue,{"list-data":b.value,loading:F.value,type:"pending",onView:f,onHandle:Q,onTransfer:Z,onTrack:S},null,8,["list-data","loading"])]),_:1}),e(B,{label:"已办公文",name:"processed"},{default:t(()=>[e(ue,{"list-data":I.value,loading:F.value,type:"processed",onView:f,onTrack:S},null,8,["list-data","loading"])]),_:1}),e(B,{label:"我发起的",name:"created"},{default:t(()=>[e(ue,{"list-data":O.value,loading:F.value,type:"created",onView:f,onRevoke:w,onTrack:S},null,8,["list-data","loading"])]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(o,{modelValue:z.value,"onUpdate:modelValue":D[2]||(D[2]=v=>z.value=v),title:"新建公文",width:"650px","destroy-on-close":""},{default:t(()=>[e(Pe,{ref_key:"documentFormRef",ref:g,onSubmit:H,onCancel:D[1]||(D[1]=v=>z.value=!1)},null,512)]),_:1},8,["modelValue"]),e(o,{modelValue:C.value,"onUpdate:modelValue":D[4]||(D[4]=v=>C.value=v),title:i.value,width:"650px","destroy-on-close":""},{default:t(()=>[r.value?(s(),$(ot,{key:0,document:r.value,onSubmit:V,onCancel:D[3]||(D[3]=v=>C.value=!1)},null,8,["document"])):h("",!0)]),_:1},8,["modelValue","title"]),e(o,{modelValue:N.value,"onUpdate:modelValue":D[5]||(D[5]=v=>N.value=v),title:"公文流转记录",width:"800px"},{default:t(()=>[r.value?(s(),$(kt,{key:0,"document-id":r.value.id},null,8,["document-id"])):h("",!0)]),_:1},8,["modelValue"]),n("div",Vt,[e(l,{content:"新建公文",placement:"left"},{default:t(()=>[e(m,{type:"primary",circle:"",class:"float-btn float-btn-primary",onClick:j},{default:t(()=>[e(U,null,{default:t(()=>[e(J(re))]),_:1})]),_:1})]),_:1}),e(l,{content:"刷新",placement:"left"},{default:t(()=>[e(m,{type:"info",circle:"",class:"float-btn float-btn-info",onClick:a},{default:t(()=>[e(U,null,{default:t(()=>[e(J(ce))]),_:1})]),_:1})]),_:1}),e(l,{content:"回到顶部",placement:"left"},{default:t(()=>[e(m,{circle:"",class:"float-btn",onClick:M},{default:t(()=>[e(U,null,{default:t(()=>[e(J(Ie))]),_:1})]),_:1})]),_:1})])])}}}),Ft=le(ht,[["__scopeId","data-v-552945fe"]]);export{Ft as default};
